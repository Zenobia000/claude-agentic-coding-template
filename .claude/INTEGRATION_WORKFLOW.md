# 🔄 CLAUDE_TEMPLATE 與 .claude 系統整合流程

## 🎯 整合目標

將 CLAUDE_TEMPLATE_zh-TW.md 的專案初始化與 .claude Subagent 系統及 VibeCoding 範本完全整合，提供無縫的「專案誕生到交付」全流程。

## 🚀 統一初始化流程

### 階段 1: 自動偵測與啟動 (CLAUDE_TEMPLATE)

```
偵測標記：<!-- CLAUDE_CODE_PROJECT_TEMPLATE_V2 -->
         ↓
Claude Code 顯示：
"🤖 偵測到專案初始化模板。您想要我設定一個新專案嗎？"
         ↓
用戶同意 → 進入整合初始化流程
```

### 階段 2: 整合需求收集

**基礎資訊收集 (來自 CLAUDE_TEMPLATE)**
```
1. 專案名稱
2. 簡要描述
3. 主要程式語言
4. GitHub 設定偏好
```

**深度需求澄清 (來自 VibeCoding 7問)**
```
由 workflow-template-manager 主導：

🎯 問題 1: 核心問題定義
"這個專案主要解決什麼問題？請描述目標用戶和他們遇到的痛點。"

🎯 問題 2: 核心功能範圍
"這個專案的核心功能有哪些？請列出 3-5 個最重要的功能。"

🎯 問題 3: 技術偏好和約束
"您對技術選型有什麼偏好或限制？"

🎯 問題 4: 用戶體驗期望
"您希望用戶在使用這個應用時有什麼樣的體驗？"

🎯 問題 5: 規模和性能要求
"預期的用戶規模和性能要求是什麼？"

🎯 問題 6: 時程和資源限制
"專案的時間限制和可用資源是什麼？"

🎯 問題 7: 成功標準定義
"如何衡量這個專案的成功？有什麼具體的指標嗎？"
```

### 階段 3: AI 分析建議與人類決策 👤

**workflow-template-manager 分析建議**
```
基於收集的資訊提供建議：
1. 分析專案複雜度 (簡易/標準/AI-ML) + 理由
2. 推薦 VibeCoding 模式 (Full Process/MVP Lean) + 理由
3. 建議資料夾結構範本 + 理由
4. 風險評估與緩解建議
```

**人類決策確認**
```
📊 AI 建議 vs 用戶決策：

🤖 AI 建議：
- 建議專案複雜度：[AI 分析] 理由：[分析依據]
- 建議工作流程：[AI 推薦] 理由：[推薦依據]
- 建議架構：[AI 建議結構] 理由：[建議理由]

👤 用戶最終決策：
- 確認專案複雜度：[等待用戶選擇]
- 確認工作流程：[等待用戶選擇]
- 確認資料夾結構：[等待用戶選擇]
- 特殊需求：[等待用戶補充]

⚠️ 系統等待用戶確認後才繼續執行
```

### 階段 4: 整合式架構建置 (基於用戶決策)

**4.1 建立 .claude 系統 (固定)**
```bash
mkdir -p .claude/{agents,context,coordination,templates}
mkdir -p .claude/context/{workflow,decisions,quality,testing,e2e,security,deployment,docs}
```

**4.2 建立專案結構 (基於用戶確認的選擇)**
```bash
# 僅在用戶確認後執行對應結構
echo "執行用戶確認的配置..."

if [[ "$USER_CHOICE" == "簡易" ]]; then
    mkdir -p {src,tests,docs,output}
elif [[ "$USER_CHOICE" == "標準" ]]; then
    mkdir -p {src,docs,tools,examples,output}
    mkdir -p src/{main,test}
    mkdir -p src/main/{python,resources}  # 基於用戶選擇的語言
    mkdir -p src/main/python/{core,utils,models,services,api}
elif [[ "$USER_CHOICE" == "AI-ML" ]]; then
    mkdir -p {data,notebooks,models,experiments,src,docs,output}
else
    echo "執行用戶自訂結構..."
fi

# 整合 .claude 系統 (所有類型都包含)
mkdir -p .claude/{agents,context,coordination,templates}
```

**4.3 生成整合式 CLAUDE.md**
```bash
# 合併 CLAUDE_TEMPLATE 內容 + VibeCoding 需求澄清結果 + 用戶確認決策 + .claude 系統規則
cat > CLAUDE.md << EOF
# CLAUDE.md - [PROJECT_NAME]

## 🎯 專案概述 (基於 VibeCoding 7問澄清)
- 核心問題：[從問題1]
- 目標用戶：[從問題1]
- 主要功能：[從問題2]
- 技術約束：[從問題3]
- 用戶體驗：[從問題4]
- 規模要求：[從問題5]
- 時程限制：[從問題6]
- 成功標準：[從問題7]

## 🏗️ Linus 開發心法 (來自 CLAUDE_TEMPLATE)
[完整的 Linus Torvalds 開發理念和溝通原則]

## 🤖 .claude Subagent 協作系統
[7個專業 Agent 的配置和協作規則]

## 🎨 VibeCoding 工作流程
模式：[Full Process/MVP Lean]
階段規劃：[基於 workflow-template-manager 分析]

## 🚨 關鍵規則 (來自 CLAUDE_TEMPLATE)
[所有禁止事項和強制要求]
EOF
```

### 階段 5: 工作流程啟動

**5.1 初始提交**
```bash
git init
git add .
git commit -m "chore(init): integrate CLAUDE_TEMPLATE with .claude system

✅ Project initialized with VibeCoding 7-question clarification
✅ Integrated .claude Subagent collaboration system
✅ Applied Linus development philosophy and rules
✅ Set up [PROJECT_TYPE] structure with [WORKFLOW_MODE] mode
✅ Configured 7 specialized agents for project lifecycle

🤖 Generated by integrated CLAUDE_TEMPLATE + .claude workflow"
```

**5.2 GitHub 設定**
```bash
# 執行 CLAUDE_TEMPLATE 的 GitHub 設定流程
```

**5.3 啟動 workflow-template-manager**
```bash
# 自動生成第一個工作流程報告
claude code task --agent workflow-template-manager \
  "基於專案初始化資訊，生成完整的開發階段規劃和 Agent 協作計畫"
```

## 🔄 整合後的工作流程

### 完整開發生命週期

```
專案初始化 (CLAUDE_TEMPLATE + VibeCoding 7問)
         ↓
workflow-template-manager 生成開發規劃
         ↓
Phase 1: 需求文檔化 (documentation-specialist)
         ↓
Phase 2: 架構設計 (主 Agent + security審查)
         ↓
Phase 3: 開發實作 (code-quality + test-automation)
         ↓
Phase 4: 驗證部署 (e2e-validation + deployment-ops)
         ↓
持續維護和優化
```

### Agent 協作觸發點

```
初始化完成 → workflow-template-manager
需求變更 → workflow-template-manager → 相關 agents
程式碼提交 → code-quality-specialist
測試階段 → test-automation-engineer
UI 完成 → e2e-validation-specialist
安全檢查 → security-infrastructure-auditor
部署準備 → deployment-operations-engineer
文檔更新 → documentation-specialist
```

## 🎯 關鍵改進點

### 1. 消除衝突
- **統一需求澄清**：先基礎資訊，再 VibeCoding 7問深挖
- **整合資料夾結構**：CLAUDE_TEMPLATE 結構 + .claude 系統目錄
- **統一工作流程**：一次初始化，全生命週期支援

### 2. 強化功能
- **智能判斷**：workflow-template-manager 分析專案特性
- **自動配置**：基於需求自動選擇最適合的設定
- **無縫銜接**：從初始化到交付的完整鏈條

### 3. 保持一致性
- **單一 CLAUDE.md**：整合所有規則和上下文
- **標準化流程**：每個階段都有明確的觸發和產出
- **可追溯性**：完整記錄所有決策和變更

## 🚀 使用指南

### 對於開發者
1. 放置 CLAUDE_TEMPLATE_zh-TW.md 到專案根目錄
2. Claude Code 自動偵測並啟動整合流程
3. 回答 VibeCoding 7問，獲得客製化專案設定
4. 按照生成的工作流程進行開發

### 對於 Claude Code
1. 偵測模板標記時，啟動整合初始化
2. 依序執行：基礎資訊 → 7問澄清 → 智能分析 → 架構建置
3. 生成整合式 CLAUDE.md 作為全專案上下文
4. 啟動 workflow-template-manager 開始專案生命週期

---

**🎯 這套整合流程確保從專案想法到最終交付的每個環節都有最佳實踐支援，消除了所有衝突和疏失。**